#include <unistd.h>
#include <sys/syscall.h>

#include "dangless/syscallmeta.h"

// dangless/build/syscallmeta.inc is generated by scripts/generate_syscall_metadata.py

static int g_syscall_ptr_params[][SYSCALL_MAX_NUM_ARGS + 1] = {
  #define SYSCALL_USERPTR_PARAMS(NAME, ...) \
    [__NR_##NAME] = { __VA_ARGS__ },

  #include "dangless/build/syscallmeta.inc"
};

const int *syscall_get_userptr_params(index_t syscallno) {
  if (syscallno >= ARRAY_LENGTH(g_syscall_ptr_params)
      || g_syscall_ptr_params[syscallno][0] == 0)
    return NULL;

  return g_syscall_ptr_params[syscallno];
}

static const char *g_syscall_names[] = {
  #define SYSCALL_SIGNATURE(RETTY, NAME, NUM_PARAMS, ...) \
    [__NR_##NAME] = #NAME,

  #include "dangless/build/syscallmeta.inc"
};

const char *syscall_get_name(index_t syscallno) {
  if (syscallno >= ARRAY_LENGTH(g_syscall_names))
    return NULL;

  return g_syscall_names[syscallno];
}
